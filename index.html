<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Convergent Frontier: AI-Powered Biorobotics</title>
    <!-- Chosen Palette: Nano-Tech Harmony -->
    <!-- Application Structure Plan: The SPA is designed as a narrative journey, guiding the user from foundational concepts to future possibilities. It starts with an introduction to the three core pillars (CNMs, Biorobotics, AI). The user can interactively explore each pillar. The structure then flows into a 'Synthesis' section, showcasing real-world applications as interactive case studies, which is more intuitive than a linear report chapter. This is followed by a visual exploration of global research trends and key challenges, using charts and interactive cards to make dense data digestible. The flow concludes with a future outlook. This thematic, non-linear structure prioritizes user engagement and understanding by breaking down complex topics into manageable, interactive modules. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Taxonomy of CNMs, Propulsion Methods, AI Spectrum. Goal: Inform & Compare. Viz/Presentation: Interactive card grids and vertical timelines built with HTML/Tailwind. Interaction: Click/hover to reveal detailed descriptions. Justification: This allows for progressive disclosure of information, preventing cognitive overload. Library/Method: Vanilla JS for DOM manipulation.
        - Report Info: R&D Funding & Market Projections. Goal: Compare & Show Change. Viz/Presentation: Bar chart and Line chart. Interaction: Tooltips on hover provide specific data points. Justification: Charts offer a quick, high-level understanding of quantitative trends which is more effective than tables. Library/Method: Chart.js for responsive, canvas-based charts.
        - Report Info: Applications (Oncology, Tissue Repair, etc.). Goal: Organize & Inform. Viz/Presentation: A tabbed interface with structured HTML/CSS diagrams. Interaction: Clicking tabs switches between detailed application scenarios. Gemini API buttons added to generate abstracts and patient explanations. Justification: Tabs organize complex scenarios neatly. Generative AI features add a layer of dynamic exploration and understanding. Library/Method: Vanilla JS, Gemini API via fetch.
        - Report Info: Translational Barriers (Biocompatibility, Ethics). Goal: Organize & Inform. Viz/Presentation: A three-column layout with interactive cards. Interaction: Subtle hover effects draw attention. Justification: This visually separates the distinct challenge categories for clarity. Library/Method: HTML/Tailwind CSS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
        }
        .nav-link.active {
            color: #38bdf8; /* text-sky-400 */
            border-bottom-color: #38bdf8;
        }
        .pillar-card, .app-tab, .challenge-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .pillar-card:hover, .challenge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .app-tab.active {
            background-color: #0ea5e9; /* bg-sky-500 */
            color: white;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 40vh;
            width: 100%;
            max-width: 900px;
            max-height: 400px;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #e2e8f0; /* bg-slate-200 */
            border: 4px solid #f1f5f9; /* bg-slate-100 */
        }
        .timeline-item.active::before {
            background-color: #0ea5e9; /* bg-sky-500 */
        }
        .gemini-btn {
            background: linear-gradient(to right, #38bdf8, #3b82f6);
            transition: all 0.3s ease;
        }
        .gemini-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
        }
        #gemini-modal-backdrop {
            display: none;
        }
        #gemini-modal-backdrop.visible {
            display: flex;
        }
        .spinner {
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-700">

    <nav class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl text-sky-600">Biorobotics Frontier</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#hero" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">Home</a>
                        <a href="#pillars" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">The Pillars</a>
                        <a href="#synthesis" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">Synthesis</a>
                        <a href="#challenges" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">Challenges</a>
                        <a href="#landscape" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">Landscape</a>
                        <a href="#outlook" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-500 border-b-2 border-transparent">Outlook</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main>
        <section id="hero" class="pt-20 pb-16 min-h-screen flex items-center bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold text-slate-800 tracking-tight">
                    The Convergent Frontier
                </h1>
                <p class="mt-4 max-w-3xl mx-auto text-lg sm:text-xl text-slate-600">
                    Exploring AI-Powered Carbon Nanomaterial Biorobots for Next-Generation Medicine.
                </p>
                <div class="mt-10 max-w-4xl mx-auto grid md:grid-cols-3 gap-8">
                    <div class="text-center p-6 bg-slate-50 rounded-xl">
                        <div class="text-4xl text-sky-500">◈</div>
                        <h3 class="mt-4 text-lg font-bold text-slate-900">Carbon Nanomaterials</h3>
                        <p class="mt-2 text-sm text-slate-600">The versatile, functional chassis for building nanoscale medical devices.</p>
                    </div>
                    <div class="text-center p-6 bg-slate-50 rounded-xl">
                        <div class="text-4xl text-sky-500">⧰</div>
                        <h3 class="mt-4 text-lg font-bold text-slate-900">Biorobotics</h3>
                        <p class="mt-2 text-sm text-slate-600">The physical effectors providing active mobility and intervention capabilities.</p>
                    </div>
                    <div class="text-center p-6 bg-slate-50 rounded-xl">
                         <div class="text-4xl text-sky-500">⧉</div>
                        <h3 class="mt-4 text-lg font-bold text-slate-900">Artificial Intelligence</h3>
                        <p class="mt-2 text-sm text-slate-600">The cognitive engine enabling perception, autonomy, and adaptive control.</p>
                    </div>
                </div>
                <p class="mt-12 text-md text-slate-500">This interactive report synthesizes cutting-edge research to explore the technology, applications, and challenges shaping the future of medicine. Scroll to begin your exploration.</p>
            </div>
        </section>

        <section id="pillars" class="py-20 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-slate-800">The Three Pillars of Revolution</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">This new medical paradigm is built upon the synergistic integration of three core technologies. Click on each pillar to explore its foundational principles and diverse capabilities.</p>
                </div>
                <div class="mt-12">
                    <div class="flex justify-center border-b border-slate-200">
                        <button data-tab="cnm" class="pillar-tab active px-6 py-3 font-medium text-slate-800">Carbon Nanomaterials</button>
                        <button data-tab="robotics" class="pillar-tab px-6 py-3 font-medium text-slate-500">Biorobotics</button>
                        <button data-tab="ai" class="pillar-tab px-6 py-3 font-medium text-slate-500">Artificial Intelligence</button>
                    </div>
                    <div id="cnm-content" class="pillar-content active mt-8">
                         <p class="text-center text-slate-600 mb-8">CNMs are the functional building blocks, providing a versatile platform for diagnostics and therapeutics. Their unique properties are tailored through synthesis and functionalization. Explore the key types below.</p>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                            <!-- CNM Cards will be dynamically inserted here -->
                        </div>
                    </div>
                    <div id="robotics-content" class="pillar-content mt-8 hidden">
                        <p class="text-center text-slate-600 mb-8">Biorobotics introduces active mobility, enabling navigation within complex biological environments. Propulsion is a key challenge, with various strategies offering different trade-offs between control and autonomy.</p>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                            <!-- Robotics Cards will be dynamically inserted here -->
                        </div>
                    </div>
                    <div id="ai-content" class="pillar-content mt-8 hidden">
                         <p class="text-center text-slate-600 mb-8">AI provides the cognitive engine for autonomy, evolving from simple controllers to adaptive learning systems. It enables perception, navigation, and decision-making in unpredictable environments.</p>
                        <div id="ai-timeline-container" class="max-w-4xl mx-auto">
                            <!-- AI Timeline will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="synthesis" class="py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-slate-800">Synthesis: Visionary Applications</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">By integrating materials, mechanics, and intelligence, we can create systems that autonomously perform complex medical tasks. This section showcases how these pillars converge in key application areas.</p>
                </div>
                <div class="mt-12 max-w-5xl mx-auto">
                    <div class="flex flex-wrap justify-center gap-2 mb-8">
                        <button data-app="oncology" class="app-tab active text-sm sm:text-base px-4 py-2 font-semibold rounded-full">Precision Oncology</button>
                        <button data-app="regenerative" class="app-tab text-sm sm:text-base px-4 py-2 font-semibold rounded-full">Regenerative Medicine</button>
                        <button data-app="gi" class="app-tab text-sm sm:text-base px-4 py-2 font-semibold rounded-full">GI Tract Navigation</button>
                        <button data-app="diagnostics" class="app-tab text-sm sm:text-base px-4 py-2 font-semibold rounded-full">Real-Time Diagnostics</button>
                    </div>
                    <div id="app-content-container" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg min-h-[300px]">
                        <!-- Application content will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </section>

        <section id="challenges" class="py-20 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-slate-800">Translational Barriers</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">The path from lab to clinic is fraught with scientific, engineering, and ethical obstacles that must be overcome.</p>
                </div>
                <div id="challenges-container" class="mt-12 grid md:grid-cols-3 gap-8">
                    <!-- Challenges will be dynamically inserted here -->
                </div>
            </div>
        </section>

        <section id="landscape" class="py-20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-slate-800">The Global Research Landscape</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">This field is an arena of intense international competition, driven by massive government investment and a rapidly growing market.</p>
                </div>
                <div class="mt-12 grid lg:grid-cols-2 gap-12 items-center">
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                         <h3 class="text-xl font-bold text-center text-slate-800 mb-4">Nanotech Research Funding (Select Programs)</h3>
                        <div class="chart-container">
                            <canvas id="fundingChart"></canvas>
                        </div>
                         <p class="text-xs text-slate-500 mt-4 text-center">Funding figures represent specific, major initiatives and are not comprehensive national totals. Sources: NNI, NSFC, EU Framework Programmes.</p>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                        <h3 class="text-xl font-bold text-center text-slate-800 mb-4">Nanomedicine Market Growth Projection</h3>
                         <div class="chart-container">
                            <canvas id="marketChart"></canvas>
                        </div>
                        <p class="text-xs text-slate-500 mt-4 text-center">Projected market size in USD, illustrating a robust Compound Annual Growth Rate (CAGR). Sources: Market analysis reports.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="outlook" class="py-20 bg-white">
             <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-extrabold text-slate-800">Future Outlook</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">The development of this field will likely proceed in stages, with increasing complexity and autonomy over time.</p>
                </div>
                <div class="mt-12 grid md:grid-cols-2 gap-12">
                     <div class="p-8 bg-slate-100 rounded-2xl">
                        <h3 class="text-2xl font-bold text-sky-600">Near-Term (5-10 Years)</h3>
                        <ul class="mt-4 space-y-3 list-disc list-inside text-slate-600">
                            <li>Advanced preclinical testing of hybrid biorobots (e.g., "twin-bioengine" systems).</li>
                            <li>Improved AI-assisted guidance for magnetically/acoustically controlled swarms.</li>
                            <li>First Phase I clinical trials for highly localized conditions (e.g., ocular diseases).</li>
                            <li>Wider use of AI in optimizing nanoparticle design and predicting patient response.</li>
                        </ul>
                    </div>
                    <div class="p-8 bg-slate-800 text-white rounded-2xl">
                        <h3 class="text-2xl font-bold text-sky-400">Long-Term (10-25 Years)</h3>
                        <ul class="mt-4 space-y-3 list-disc list-inside text-slate-300">
                            <li>Fully autonomous swarms performing complex in-vivo microsurgery.</li>
                            <li>Continuous in-body monitoring via resident nanorobot sensor networks.</li>
                            <li>Realization of true P5 medicine (Predictive, Personalized, Preventive, Participatory, Precise).</li>
                            <li>Potential for personalized, on-demand drug synthesis directly at the site of need.</li>
                        </ul>
                    </div>
                </div>
             </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-white">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p>Interactive report generated from "The Convergent Frontier" research paper.</p>
            <p class="mt-2 text-slate-400">This application is for illustrative and educational purposes only.</p>
        </div>
    </footer>
    
    <!-- Gemini Modal -->
    <div id="gemini-modal-backdrop" class="fixed inset-0 bg-black bg-opacity-60 items-center justify-center p-4 z-50">
        <div id="gemini-modal" class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b border-slate-200">
                <h3 id="gemini-modal-title" class="text-lg font-bold text-slate-800">AI Generated Content</h3>
                <button id="gemini-modal-close" class="text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div id="gemini-modal-content" class="p-6 overflow-y-auto">
                <div id="gemini-spinner-container" class="flex justify-center items-center h-48">
                    <div class="spinner w-12 h-12 rounded-full border-4 border-slate-200"></div>
                </div>
                <div id="gemini-output-text" class="text-slate-700 leading-relaxed"></div>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const pillarData = {
                cnm: [
                    { title: 'Graphene / Graphene Oxide', description: 'A 2D monolayer of carbon with exceptional strength and conductivity. Used for biosensing, tissue scaffolds, and drug delivery.', icon: '⬢' },
                    { title: 'Carbon Nanotubes (CNTs)', description: '1D cylindrical molecules that absorb NIR light, making them ideal for photothermal therapy and as drug carriers.', icon: '│' },
                    { title: 'Carbon Quantum Dots (CQDs)', description: '0D nanoparticles with tunable photoluminescence, excellent for high-contrast bioimaging and sensing.', icon: '•' },
                    { title: 'Nanodiamonds', description: '0D particles with an inert, biocompatible core, serving as stable platforms for drug delivery.', icon: '◆' },
                    { title: 'Fullerenes', description: '0D cage-like structures capable of encapsulating drug molecules for targeted delivery.', icon: '⬡' }
                ],
                robotics: [
                    { title: 'Magnetic Propulsion', description: 'Uses external magnetic fields to steer robots. Offers high precision but requires bulky equipment.', icon: '🧲' },
                    { title: 'Acoustic Propulsion', description: 'Converts ultrasound waves into thrust. Offers wireless power and good tissue penetration.', icon: '🔊' },
                    { title: 'Chemical Propulsion', description: 'Uses onboard catalytic reactions for untethered, autonomous movement, often fueled by local biomarkers.', icon: '🧪' },
                    { title: 'Biomimetic Propulsion', description: 'Mimics biological structures like flagella for efficient movement in viscous fluids.', icon: '⪡' },
                    { title: 'Biohybrid Robots', description: 'Hijacks motile microorganisms or cells (e.g., macrophages) to carry payloads, offering excellent biocompatibility.', icon: '🦠' }
                ],
                ai: [
                    { title: 'PID Controllers', description: 'Early rule-based systems for simple error correction. Effective in stable environments but brittle against unpredictable biological forces.' },
                    { title: 'Machine Learning', description: 'Used for prediction and pattern recognition. Can analyze patient data (EHRs, genomics) for pre-mission planning and risk stratification.' },
                    { title: 'Deep Learning (CNNs)', description: 'Enables real-time perception. AI can "see" via medical imaging (MRI, ultrasound) to identify robots, track movement, and segment anatomical structures.' },
                    { title: 'Reinforcement Learning (RL)', description: 'The path to true autonomy. AI agents learn optimal control strategies through trial-and-error, mastering navigation in dynamic, chaotic environments like blood flow.' },
                    { title: 'AI Swarm Control', description: 'Coordinates the collective behavior of millions of nanorobots, guiding them as a single, reconfigurable entity to perform complex tasks.' }
                ]
            };

            const appData = {
                oncology: {
                    title: "Precision Oncology",
                    description: "AI-guided swarms of CNT-based nanorobots navigate to tumors for a multi-pronged attack. The AI uses real-time imaging to guide the swarm, which then delivers concentrated chemotherapy and performs photothermal therapy (PTT) by converting NIR light to heat, destroying cancer cells with minimal damage to healthy tissue.",
                    steps: ["Injection & AI Guidance", "Tumor Accumulation", "Dual-Action Therapy (Chemo + PTT)"]
                },
                regenerative: {
                    title: "In-Situ Tissue Repair",
                    description: "An AI-controlled system orchestrates wound healing. Nanorobots deposit a graphene oxide (GO) hydrogel scaffold that provides an antibacterial barrier and a framework for cell growth. Embedded biosensors feed data to the AI, which adaptively releases growth factors to manage regeneration.",
                    steps: ["Scaffold Deposition", "Real-time Monitoring", "Adaptive Growth Factor Release"]
                },
                gi: {
                    title: "GI Tract Navigation",
                    description: "Advanced biohybrid systems like the 'Twin-Bioengine' Yeast Robot (TBY-robot) navigate the harsh GI environment. It uses an enzyme-driven engine to penetrate the mucus barrier, then gets carried by the body's own immune cells (macrophages) to deep-seated inflammation sites for targeted drug release.",
                    steps: ["Oral Administration", "Enzyme-driven Propulsion", "Macrophage Hijacking & Homing"]
                },
                diagnostics: {
                    title: "Real-Time In-Vivo Diagnostics",
                    description: "A resident swarm of AI-powered nanorobots patrols the bloodstream, acting as a distributed sensor network. They continuously detect molecular biomarkers for diseases like cancer or neurodegeneration. A wearable device collects data, and a cloud AI detects anomalies, enabling intervention before symptoms appear.",
                    steps: ["Deployment & Patrol", "Continuous Biomarker Sensing", "AI Anomaly Detection & Alert"]
                }
            };
            
            let currentApp = 'oncology';

            const challengesData = [
                { title: 'Biocompatibility', description: 'Ensuring materials are non-toxic and don\'t trigger harmful immune responses. Key concerns include long-term accumulation, degradation byproducts, and blood compatibility.', icon: '🛡️' },
                { title: 'Engineering Hurdles', description: 'Solving fundamental problems of power, data transmission, and control. This includes powering devices deep in the body and navigating swarms of millions of robots in chaotic environments.', icon: '⚙️' },
                { title: 'Ethical & Regulatory', description: 'Addressing the "black box" problem of AI accountability. Who is responsible for an autonomous robot\'s error? Also includes data privacy, algorithmic bias, and equitable access to these advanced therapies.', icon: '⚖️' }
            ];

            function renderPillarContent() {
                const cnmContainer = document.querySelector('#cnm-content .grid');
                cnmContainer.innerHTML = pillarData.cnm.map(item => `
                    <div class="pillar-card bg-white p-6 rounded-lg shadow-md border border-slate-200">
                        <div class="text-3xl">${item.icon}</div>
                        <h4 class="font-bold text-slate-800 mt-4">${item.title}</h4>
                        <p class="text-sm text-slate-600 mt-2">${item.description}</p>
                    </div>
                `).join('');

                const roboticsContainer = document.querySelector('#robotics-content .grid');
                roboticsContainer.innerHTML = pillarData.robotics.map(item => `
                    <div class="pillar-card bg-white p-6 rounded-lg shadow-md border border-slate-200">
                        <div class="text-3xl">${item.icon}</div>
                        <h4 class="font-bold text-slate-800 mt-4">${item.title}</h4>
                        <p class="text-sm text-slate-600 mt-2">${item.description}</p>
                    </div>
                `).join('');

                const aiContainer = document.getElementById('ai-timeline-container');
                aiContainer.innerHTML = `
                    <div class="relative pl-8 border-l-2 border-slate-200">
                        ${pillarData.ai.map((item, index) => `
                        <div class="timeline-item mb-10 ${index === 0 ? 'active' : ''}">
                            <h4 class="font-bold text-slate-800 text-lg">${item.title}</h4>
                            <p class="text-slate-600 mt-1">${item.description}</p>
                        </div>
                        `).join('')}
                    </div>
                `;
            }
            
            function renderApplicationContent(appName) {
                currentApp = appName;
                const data = appData[appName];
                const container = document.getElementById('app-content-container');
                container.innerHTML = `
                    <h3 class="text-2xl font-bold text-slate-800 text-center">${data.title}</h3>
                    <p class="mt-4 text-slate-600 text-center max-w-2xl mx-auto">${data.description}</p>
                    <div class="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4 sm:gap-8">
                        ${data.steps.map((step, index) => `
                            <div class="flex items-center">
                                <span class="flex items-center justify-center w-8 h-8 rounded-full bg-sky-100 text-sky-600 font-bold">${index + 1}</span>
                                <span class="ml-3 font-medium text-slate-700 text-center sm:text-left">${step}</span>
                            </div>
                            ${index < data.steps.length - 1 ? '<div class="hidden sm:block text-2xl text-slate-300">→</div>' : ''}
                        `).join('')}
                    </div>
                    <div class="mt-10 pt-6 border-t border-slate-200 flex flex-col sm:flex-row justify-center gap-4">
                        <button id="generate-abstract-btn" class="gemini-btn text-white font-bold py-2 px-4 rounded-full">
                            ✨ Generate Research Abstract
                        </button>
                        <button id="explain-patient-btn" class="gemini-btn text-white font-bold py-2 px-4 rounded-full">
                            ✨ Explain to a Patient
                        </button>
                    </div>
                `;
                document.getElementById('generate-abstract-btn').addEventListener('click', handleGenerateAbstract);
                document.getElementById('explain-patient-btn').addEventListener('click', handleExplainToPatient);
            }
            
            function renderChallenges() {
                const container = document.getElementById('challenges-container');
                container.innerHTML = challengesData.map(challenge => `
                     <div class="challenge-card bg-white p-8 rounded-2xl shadow-md border border-slate-100 text-center">
                        <div class="text-5xl mx-auto">${challenge.icon}</div>
                        <h3 class="mt-6 text-xl font-bold text-slate-800">${challenge.title}</h3>
                        <p class="mt-2 text-slate-600">${challenge.description}</p>
                    </div>
                `).join('');
            }

            const pillarTabs = document.querySelectorAll('.pillar-tab');
            const pillarContents = document.querySelectorAll('.pillar-content');
            pillarTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    pillarTabs.forEach(t => t.classList.remove('active', 'text-slate-800'));
                    pillarContents.forEach(c => c.classList.add('hidden'));
                    
                    tab.classList.add('active', 'text-slate-800');
                    document.getElementById(`${tab.dataset.tab}-content`).classList.remove('hidden');
                });
            });
            
            const appTabs = document.querySelectorAll('.app-tab');
            appTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    appTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    renderApplicationContent(tab.dataset.app);
                });
            });

            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                        });
                    }
                });
            }, { rootMargin: "-50% 0px -50% 0px" });
            sections.forEach(sec => observer.observe(sec));
            
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelector(link.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });


            const fundingData = {
                labels: ['USA (NNI/NIH)', 'China (NSFC/973)', 'EU (Horizon)', 'Japan (MEXT)'],
                datasets: [{
                    label: 'Funding in Billion USD (Selected Initiatives)',
                    data: [3.7, 1.6, 1.3, 0.8],
                    backgroundColor: ['rgba(56, 189, 248, 0.6)','rgba(248, 113, 113, 0.6)','rgba(251, 191, 36, 0.6)','rgba(139, 92, 246, 0.6)'],
                    borderColor: ['rgba(56, 189, 248, 1)','rgba(248, 113, 113, 1)','rgba(251, 191, 36, 1)','rgba(139, 92, 246, 1)'],
                    borderWidth: 1
                }]
            };

            const marketData = {
                labels: ['2022', '2024', '2026', '2028', '2030'],
                datasets: [{
                    label: 'Market Size (Billion USD)',
                    data: [280, 400, 570, 780, 964],
                    fill: true,
                    backgroundColor: 'rgba(20, 184, 166, 0.2)',
                    borderColor: 'rgba(20, 184, 166, 1)',
                    tension: 0.4
                }]
            };
            
            const chartOptions = {
                maintainAspectRatio: false,
                responsive: true,
                plugins: { legend: { display: false }, tooltip: { backgroundColor: '#1e293b', titleFont: { size: 14, weight: 'bold' }, bodyFont: { size: 12 }, padding: 10, cornerRadius: 4, displayColors: false } },
                scales: { y: { beginAtZero: true, grid: { color: '#e2e8f0' }, ticks: { color: '#64748b' } }, x: { grid: { display: false }, ticks: { color: '#64748b' } } }
            };
            
            new Chart(document.getElementById('fundingChart'), { type: 'bar', data: fundingData, options: { ...chartOptions, indexAxis: 'y' } });
            new Chart(document.getElementById('marketChart'), { type: 'line', data: marketData, options: chartOptions });

            async function callGeminiAPI(prompt) {
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                       throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        console.error('Unexpected response structure:', result);
                        return "Error: Could not extract text from the API response.";
                    }
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    return `Error: Could not connect to the generative AI service. ${error.message}`;
                }
            }

            const modalBackdrop = document.getElementById('gemini-modal-backdrop');
            const modalTitle = document.getElementById('gemini-modal-title');
            const modalContent = document.getElementById('gemini-output-text');
            const spinner = document.getElementById('gemini-spinner-container');
            const closeModalBtn = document.getElementById('gemini-modal-close');

            function showModal(title) {
                modalTitle.textContent = title;
                modalContent.innerHTML = '';
                spinner.style.display = 'flex';
                modalBackdrop.classList.add('visible');
            }

            function hideModal() {
                modalBackdrop.classList.remove('visible');
            }
            
            closeModalBtn.addEventListener('click', hideModal);
            modalBackdrop.addEventListener('click', (e) => {
                if (e.target === modalBackdrop) {
                    hideModal();
                }
            });

            async function handleGenerateAbstract() {
                const data = appData[currentApp];
                const prompt = `You are a research scientist in nanomedicine. Based on the following information about a hypothetical medical technology, write a formal, structured research paper abstract of 150-200 words. The abstract must include these four sections: Background, Methods, Results (hypothesized), and Conclusion.\n\nTechnology Title: ${data.title}\nDescription: ${data.description}\nKey Steps: ${data.steps.join(', ')}\n\nGenerate only the text of the abstract.`;
                
                showModal('Generated Research Abstract');
                const resultText = await callGeminiAPI(prompt);
                spinner.style.display = 'none';
                modalContent.innerHTML = resultText.replace(/\n\n/g, '<br><br>').replace(/\n/g, '<br>');
            }

            async function handleExplainToPatient() {
                const data = appData[currentApp];
                const prompt = `You are a compassionate medical doctor explaining a new, complex treatment to a patient. Your goal is to be clear, reassuring, and easy to understand, avoiding technical jargon. Explain the following medical procedure in simple terms. Start with a reassuring opening and use analogies if helpful.\n\nProcedure Name: ${data.title}\nTechnical Description: ${data.description}\n\nGenerate only the explanation for the patient.`;
                
                showModal('Patient-Friendly Explanation');
                const resultText = await callGeminiAPI(prompt);
                spinner.style.display = 'none';
                modalContent.innerHTML = resultText.replace(/\n\n/g, '<br><br>').replace(/\n/g, '<br>');
            }

            renderPillarContent();
            renderApplicationContent('oncology');
            renderChallenges();

        });
    </script>
</body>
</html>
